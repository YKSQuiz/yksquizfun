"use strict";(self.webpackChunkyks_quiz=self.webpackChunkyks_quiz||[]).push([[791],{7574:(e,t,s)=>{s.d(t,{eu:()=>a,pX:()=>i,zu:()=>n});class r{constructor(){this.metrics=new Map,this.observers=[],this.initObservers()}static getInstance(){return r.instance||(r.instance=new r),r.instance}initObservers(){if("PerformanceObserver"in window){const t=new PerformanceObserver(e=>{for(const t of e.getEntries())if("navigation"===t.entryType){const e=t;this.recordMetric("navigation",e.loadEventEnd-e.loadEventStart)}});try{t.observe({entryTypes:["navigation"]}),this.observers.push(t)}catch(e){console.warn("Navigation timing not supported")}const s=new PerformanceObserver(e=>{for(const t of e.getEntries())"paint"===t.entryType&&this.recordMetric("paint",t.startTime)});try{s.observe({entryTypes:["paint"]}),this.observers.push(s)}catch(e){console.warn("Paint timing not supported")}}}recordMetric(e,t){this.metrics.has(e)||this.metrics.set(e,[]),this.metrics.get(e).push(t)}getAverageMetric(e){const t=this.metrics.get(e);return t&&0!==t.length?t.reduce((e,t)=>e+t,0)/t.length:0}getMetrics(){const e={};return this.metrics.forEach((t,s)=>{e[s]=[...t]}),e}measureAsync(e,t){const s=performance.now();return t().finally(()=>{const t=performance.now()-s;this.recordMetric(e,t)})}measureSync(e,t){const s=performance.now();try{return t()}finally{const t=performance.now()-s;this.recordMetric(e,t)}}reportMetrics(){const e=this.getMetrics();console.log("Performance Metrics:",e),this.sendToAnalytics(e)}sendToAnalytics(e){try{"undefined"!==typeof window&&window.gtag&&Object.entries(e).forEach(e=>{let[t,s]=e;const r=s.reduce((e,t)=>e+t,0)/s.length;window.gtag("event","performance_metric",{metric_name:t,metric_value:r,metric_count:s.length})})}catch(t){console.warn("Failed to send metrics to analytics:",t)}}destroy(){this.observers.forEach(e=>e.disconnect()),this.observers=[],this.metrics.clear()}}r.instance=void 0;const a=()=>{const e=r.getInstance();return{measureAsync:(t,s)=>e.measureAsync(t,s),measureSync:(t,s)=>e.measureSync(t,s),recordMetric:(t,s)=>{e.recordMetric(t,s)},getMetrics:()=>e.getMetrics(),reportMetrics:()=>e.reportMetrics()}},i=()=>{if("memory"in performance){const e=performance.memory;return{usedJSHeapSize:e.usedJSHeapSize,totalJSHeapSize:e.totalJSHeapSize,jsHeapSizeLimit:e.jsHeapSizeLimit}}return null},n=()=>{if("connection"in navigator){const e=navigator.connection;return{effectiveType:e.effectiveType,downlink:e.downlink,rtt:e.rtt}}return null}},9791:(e,t,s)=>{s.r(t),s.d(t,{default:()=>v});var r=s(5043),a=s(108),i=s(5748),n=s(7734),c=s(2185),o=s(6026),d=s(6150),h=s(168),l=s(8420),m=s(8763),u=s(3831),x=(0,l.gu)({chartName:"BarChart",GraphicalChild:m.y,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:c.W},{axisType:"yAxis",AxisComp:o.h}],formatAxisMap:u.pr}),p=s(7574),j=s(1185),g=s(579);const v=()=>{const{getMetrics:e,reportMetrics:t}=(0,p.eu)(),[s,l]=(0,r.useState)([]),[u,v]=(0,r.useState)(!1),[y,f]=(0,r.useState)(null),{variant:w,config:N}=(0,j.HC)("quiz_ui_variant"),{variant:S,config:b}=(0,j.HC)("question_loading"),M=()=>{var t;const s=(0,p.pX)(),r=(0,p.zu)(),a=e(),i={timestamp:Date.now(),memoryUsage:s?s.usedJSHeapSize/s.jsHeapSizeLimit*100:0,networkSpeed:r?r.downlink:0,loadTime:a.fetchQuestions?a.fetchQuestions.reduce((e,t)=>e+t,0)/a.fetchQuestions.length:0,cacheHitRate:a.cache_hit?a.cache_hit.length/(a.cache_hit.length+((null===(t=a.fetch_error)||void 0===t?void 0:t.length)||0))*100:0};l(e=>[...e.slice(-20),i])},T=(0,r.useMemo)(()=>s.map(e=>({time:new Date(e.timestamp).toLocaleTimeString(),memory:e.memoryUsage,network:e.networkSpeed,loadTime:e.loadTime,cacheHitRate:e.cacheHitRate})),[s]),k=(0,r.useMemo)(()=>{if(0===s.length)return null;const e=s[s.length-1],t=s.reduce((e,t)=>e+t.memoryUsage,0)/s.length,r=s.reduce((e,t)=>e+t.loadTime,0)/s.length,a=s.reduce((e,t)=>e+t.cacheHitRate,0)/s.length;return{currentMemory:(null===e||void 0===e?void 0:e.memoryUsage)||0,averageMemory:t,currentLoadTime:(null===e||void 0===e?void 0:e.loadTime)||0,averageLoadTime:r,currentCacheHitRate:(null===e||void 0===e?void 0:e.cacheHitRate)||0,averageCacheHitRate:a,dataPoints:s.length}},[s]);return(0,r.useEffect)(()=>()=>{y&&clearInterval(y)},[y]),(0,g.jsxs)("div",{className:"performance-dashboard",children:[(0,g.jsxs)("div",{className:"dashboard-header",children:[(0,g.jsx)("h1",{children:"Performance Dashboard"}),(0,g.jsx)("button",{onClick:()=>{if(u)y&&(clearInterval(y),f(null)),v(!1);else{const e=setInterval(()=>{M()},5e3);f(e),v(!0)}},className:"monitoring-btn "+(u?"active":""),children:u?"Stop Monitoring":"Start Monitoring"})]}),(0,g.jsxs)("div",{className:"ab-test-section",children:[(0,g.jsx)("h2",{children:"AB Test Status"}),(0,g.jsxs)("div",{className:"ab-test-grid",children:[(0,g.jsxs)("div",{className:"ab-test-card",children:[(0,g.jsx)("h3",{children:"UI Variant"}),(0,g.jsxs)("p",{children:["Current: ",w]}),(0,g.jsxs)("p",{children:["Progress Bar: ",N.showProgressBar?"Yes":"No"]}),(0,g.jsxs)("p",{children:["Animation Speed: ",N.animationSpeed]})]}),(0,g.jsxs)("div",{className:"ab-test-card",children:[(0,g.jsx)("h3",{children:"Loading Variant"}),(0,g.jsxs)("p",{children:["Current: ",S]}),(0,g.jsxs)("p",{children:["Cache Size: ",b.cacheSize]}),(0,g.jsxs)("p",{children:["Strategy: ",b.loadingStrategy]})]})]})]}),k&&(0,g.jsxs)("div",{className:"performance-summary",children:[(0,g.jsx)("h2",{children:"Performance Summary"}),(0,g.jsxs)("div",{className:"summary-grid",children:[(0,g.jsxs)("div",{className:"summary-card",children:[(0,g.jsx)("h3",{children:"Memory Usage"}),(0,g.jsxs)("p",{className:"current",children:[k.currentMemory.toFixed(2),"%"]}),(0,g.jsxs)("p",{className:"average",children:["Avg: ",k.averageMemory.toFixed(2),"%"]})]}),(0,g.jsxs)("div",{className:"summary-card",children:[(0,g.jsx)("h3",{children:"Load Time"}),(0,g.jsxs)("p",{className:"current",children:[k.currentLoadTime.toFixed(2),"ms"]}),(0,g.jsxs)("p",{className:"average",children:["Avg: ",k.averageLoadTime.toFixed(2),"ms"]})]}),(0,g.jsxs)("div",{className:"summary-card",children:[(0,g.jsx)("h3",{children:"Cache Hit Rate"}),(0,g.jsxs)("p",{className:"current",children:[k.currentCacheHitRate.toFixed(2),"%"]}),(0,g.jsxs)("p",{className:"average",children:["Avg: ",k.averageCacheHitRate.toFixed(2),"%"]})]}),(0,g.jsxs)("div",{className:"summary-card",children:[(0,g.jsx)("h3",{children:"Data Points"}),(0,g.jsx)("p",{className:"current",children:k.dataPoints})]})]})]}),T.length>0&&(0,g.jsxs)("div",{className:"charts-section",children:[(0,g.jsx)("h2",{children:"Performance Charts"}),(0,g.jsxs)("div",{className:"chart-grid",children:[(0,g.jsxs)("div",{className:"chart-container",children:[(0,g.jsx)("h3",{children:"Memory Usage Over Time"}),(0,g.jsx)(a.u,{width:"100%",height:300,children:(0,g.jsxs)(i.b,{data:T,children:[(0,g.jsx)(n.d,{strokeDasharray:"3 3"}),(0,g.jsx)(c.W,{dataKey:"time"}),(0,g.jsx)(o.h,{}),(0,g.jsx)(d.m,{}),(0,g.jsx)(h.N,{type:"monotone",dataKey:"memory",stroke:"#8884d8"})]})})]}),(0,g.jsxs)("div",{className:"chart-container",children:[(0,g.jsx)("h3",{children:"Load Time Over Time"}),(0,g.jsx)(a.u,{width:"100%",height:300,children:(0,g.jsxs)(i.b,{data:T,children:[(0,g.jsx)(n.d,{strokeDasharray:"3 3"}),(0,g.jsx)(c.W,{dataKey:"time"}),(0,g.jsx)(o.h,{}),(0,g.jsx)(d.m,{}),(0,g.jsx)(h.N,{type:"monotone",dataKey:"loadTime",stroke:"#82ca9d"})]})})]}),(0,g.jsxs)("div",{className:"chart-container",children:[(0,g.jsx)("h3",{children:"Cache Hit Rate"}),(0,g.jsx)(a.u,{width:"100%",height:300,children:(0,g.jsxs)(x,{data:T,children:[(0,g.jsx)(n.d,{strokeDasharray:"3 3"}),(0,g.jsx)(c.W,{dataKey:"time"}),(0,g.jsx)(o.h,{}),(0,g.jsx)(d.m,{}),(0,g.jsx)(m.y,{dataKey:"cacheHitRate",fill:"#8884d8"})]})})]}),(0,g.jsxs)("div",{className:"chart-container",children:[(0,g.jsx)("h3",{children:"Network Speed"}),(0,g.jsx)(a.u,{width:"100%",height:300,children:(0,g.jsxs)(i.b,{data:T,children:[(0,g.jsx)(n.d,{strokeDasharray:"3 3"}),(0,g.jsx)(c.W,{dataKey:"time"}),(0,g.jsx)(o.h,{}),(0,g.jsx)(d.m,{}),(0,g.jsx)(h.N,{type:"monotone",dataKey:"network",stroke:"#ffc658"})]})})]})]})]}),(0,g.jsxs)("div",{className:"export-section",children:[(0,g.jsx)("h2",{children:"Export Data"}),(0,g.jsx)("button",{onClick:()=>t(),children:"Export Metrics"}),(0,g.jsx)("button",{onClick:()=>{const e=JSON.stringify(s,null,2),t=new Blob([e],{type:"application/json"}),r=URL.createObjectURL(t),a=document.createElement("a");a.href=r,a.download="performance-data.json",a.click()},children:"Export Performance Data"})]})]})}}}]);
//# sourceMappingURL=791.e523f2f2.chunk.js.map